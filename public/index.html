<!doctype html>
<html>
    <title>V3</title>
    <head>
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-lerp-component/aframe-lerp-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
        <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
        <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>
        <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
    </head>
    <!-- arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;" -->
    <body style="margin: 0; overflow: hidden;">
        <a-scene
            embedded
            arjs="detectionMode: mono_and_matrix; matrixCodeType: 4x4_BCH_13_5_5;"
            vr-mode-ui="enabled: false;"
            loading-screen="enabled: false;"
            renderer="logarithmicDepthBuffer: true;"
            id="scene"
            gesture-detector
        >

        
        
            <a-assets id="assets">
                <video id="video1" autoplay controls loop muted playsinline webkitplaysinline src="vids/1.mp4"></video>
                <video id="video2" autoplay loop muted playsinline src="vids/2.mp4"></video>
                <!-- <video id="video3" autoplay loop muted playsinline src="ar_assets/image_3/bYQCUAgmRKpMiuo3QbrgKvHMy2onSbHl9W0jXGBgnX4.mp4"></video>
                <video id="video4" autoplay loop muted playsinline src="vids/4.mp4"></video>
                <video id="video5" autoplay loop muted playsinline src="ar_assets/image_5/CosmotionFadeOut 1 - Mac Calarco.mp4"></video>
                <video id="video6" autoplay loop muted playsinline src="ar_assets/image_6/final_hight_music - Angel Arce.mp4"></video>
                <video id="video7" autoplay loop muted playsinline src="ar_assets/image_7/Flows0xmer_-_Almer_Harahap.mp4"></video>
                <video id="video8" autoplay loop muted playsinline src="ar_assets/image_8/Fragment7_1_1 - Joel Mendez.mp4"></video>
                <video id="video9" autoplay loop muted playsinline src="ar_assets/image_9/julia - cenonym.mp4"></video>
                <video id="video10" autoplay loop muted playsinline src="ar_assets/image_10/LANDSK #15 - Orion Currier.mp4"></video>
                <video id="video11" autoplay loop muted playsinline src="ar_assets/image_11/Paradox CODA - Roadside Lake.mp4"></video>
                <video id="video12" autoplay loop muted playsinline src="ar_assets/image_12/PEACE - Noice 0x.mp4"></video>
                <video id="video13" autoplay loop muted playsinline src="ar_assets/image_13/QUEEN - Duke Nguyen.mp4"></video>
                <video id="video14" autoplay loop muted playsinline src="ar_assets/image_14/Semeya_ - Eder Cruz.mp4"></video>
                <video id="video15" autoplay loop muted playsinline src="ar_assets/image_15/SOL - Eder Cruz.mp4"></video>
                <video id="video16" autoplay loop muted playsinline src="ar_assets/image_16/something - Pea Nug.mp4"></video>
                <video id="video17" autoplay loop muted playsinline src="ar_assets/image_17/THEY DON_T KNOW - odd skull.mp4"></video>
                <video id="video18" autoplay loop muted playsinline src="ar_assets/image_18/Through the town for gif - Nick.mp4"></video>
                <video id="video19" autoplay loop muted playsinline src="ar_assets/image_19/video_20230524_191156_edit - Simp Shremp.mp4"></video>
                <video id="video20" autoplay loop muted playsinline src="ar_assets/image_20/trim.04299E89-8498-4175-BEBF-38771FE177B2 - daniar ainun.MOV"></video>
                <video id="video21" autoplay loop muted playsinline src="ar_assets/image_21/video_20230524_191156_edit - Simp Shremp.mp4"></video>
                <video id="video22" autoplay loop muted playsinline src="ar_assets/image_22/Waves_Final_wSound - Joyce Liu.mp4"></video> -->
            </a-assets>

            <a-marker type="barcode" value="1" id="marker-1">
                <a-video id="avideo1" src="#video1" position="-6 -6 -6" rotation="-90 0 0" height="12" width="12" ></a-video>
                
            </a-marker>
            <a-marker type="barcode" value="2" id="marker-2">
                <a-video id="avideo2" src="#video2" position="-6 -6 -6" rotation="-90 0 0" height="10" width="10" lerp="duration: 100" arjs-video="position: fixed;"></a-video>
            </a-marker>
            <!-- <a-marker type="barcode" value="3" id="marker-3">
                <a-video src="#video3" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="4" id="marker-4">
                <a-video src="#video4" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="5" id="marker-5">
                <a-video src="#video5" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="6" id="marker-6">
                <a-video src="#video6" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="7" id="marker-7">
                <a-video src="#video7" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="8" id="marker-8">
                <a-video src="#video8" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="9" id="marker-9">
                <a-video src="#video9" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="10" id="marker-10">
                <a-video src="#video10" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="11" id="marker-11">
                <a-video src="#video11" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="12" id="marker-12">
                <a-video src="#video12" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="13" id="marker-13">
                <a-video src="#video13" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="14" id="marker-14">
                <a-video src="#video14" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="15" id="marker-15">
                <a-video src="#video15" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="16" id="marker-16">
                <a-video src="#video16" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="17" id="marker-17">
                <a-video src="#video17" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="18" id="marker-18">
                <a-video src="#video18" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="19" id="marker-19">
                <a-video src="#video19" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="20" id="marker-20">
                <a-video src="#video20" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="21" id="marker-21">
                <a-video src="#video21" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
            <a-marker type="barcode" value="22" id="marker-22">
                <a-video src="#video22" position="0 0 0" rotation="-90 0 0" height="2" width="2"></a-video>
            </a-marker>
             -->


            <a-entity camera></a-entity>
       

        </a-scene>
    </body>
    <script>

        for (let i = 1; i < 23; i++) {
            document.querySelector(`#marker-${i}`).addEventListener('markerFound', function() {
                console.log(`Marker ${i} found`);
                var video = document.querySelector(`#video${i}`);
                video.play();

            });
            document.querySelector(`#marker-${i}`).addEventListener('markerLost', function() {
                console.log(`Marker ${i} lost`);
                // var video = document.querySelector(`#video${i}`);
                // video.pause();
                // video.currentTime = 0;
            });
        }
        
        // // Ensure the video restarts when the marker is lost and found again
        // document.querySelector('#marker-1').addEventListener('markerLost', function() {
        //     var video = document.querySelector('#video1');
        //     video.pause();
        //     video.currentTime = 0;
        // });

        AFRAME.registerComponent("listener", {
            init: function() {
                this.target = document.querySelector('#avideo1'); // your video
                this.prevPosition = null; // initially there is no position or rotation
                this.prevRotation = null;
            },

            tick: function() {
                if (this.el.object3D.visible) {
                this.target.setAttribute('visible', 'true')

                if(!this.prevPosition && !this.prevRotation) { 
                    // there are no values to lerp from - set the initial values
                    this.target.setAttribute('position', this.el.getAttribute('position'))
                    this.target.setAttribute('rotation', this.el.getAttribute('rotation'))
                } else {
                    // use the previous values to get an approximation 
                    this.target.object3D.position.lerp(this.prevPosition, 0.1)

                    // this (below) may seem ugly, but the rotation is a euler, not a THREE.Vector3, 
                    // so to use the lerp function i'm doing some probably unnecessary conversions
                    let rot = this.target.object3D.rotation.toVector3().lerp(this.prevRotation, 0.1)
                    this.target.object3D.rotation.setFromVector3(rot)
                }
                // update the values
                this.prevPosition = this.el.object3D.position
                this.prevRotation = this.el.object3D.rotation
                } else {
                // the marker dissapeared - reset the values
                this.target.setAttribute('visible', 'false')
                this.prevPosition = null;
                this.prevRotation = null;
                }
            }
        })
    
        
        
          
        
    </script> 


</html>
